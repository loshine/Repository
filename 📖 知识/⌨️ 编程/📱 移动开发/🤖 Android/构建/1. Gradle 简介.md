# Gradle 简介

> **Gradle** 是以 **Groovy** 语言为基础，面向 **Java应用** 为主。基于 **DSL**（领域特定语言）语法的自动化构建工具

## Project 和 Tasks

Gradle 里的任何东西都是基于这两个基础概念:

* `projects`( 项目 )
* `tasks` ( 任务 )

每一次构建都是有至少一个`project`来完成，每个`project`有至少一个`tasks`。每一个 **build.grade** 文件代表着一个`project`。`tasks`在 **build.gradle** 中定义。

## 构建的生命周期

一旦一个`tasks`被执行，那么它不会再次执行了，不包含依赖的`tasks`总是优先执行，一次构建将会经历下列三个阶段：

1. **初始化阶段**：`project`实例在这儿创建，如果有多个模块，即有多个 **build.gradle** 文件，多个`project`将会被创建。
2. **配置阶段**：在该阶段，**build.gradle** 脚本将会执行，为每个`project`创建和配置所有的`tasks`。
3. **执行阶段**：这一阶段，Gradle 会决定哪一个`tasks`会被执行，哪一个`tasks`会被执行完全依赖开始构建时传入的参数和当前所在的文件夹位置。

## build.gradle 的配置文件

基于 Gradle 构建的项目通常至少有一个 **build.gradle** ，Android 的 **build.gradle**：

```groovy
buildscript {
    repositories {
        jcenter()
    }
    dependencies {
        classpath 'com.android.tools.build:gradle:1.2.3'
    }
}

allprojects {
    repositories {
        jcenter()
    }
}

task clean(type: Delete) {
    delete rootProject.buildDir
}
```

这是项目构建的入口，即 Gradle 构建项目实际开始的地方。

* `buildscript`：构建脚本设置
  * `repositories`：构建项目时使用的仓库，默认使用 **JCenter** 库（类似 Maven 中央仓库），Gradle 也支持添加其它仓库。
  * `dependencies`：gradle 版本。
* `allprojects`：所有`project`设置
  * `repositories`：使用仓库
* `task clean`：定义一个`clean`任务

## 项目结构

```bash
MyApp
  ├── build.gradle
  ├── settings.gradle
  └── app
       ├── build.gradle
       ├── build
       ├── libs
       └── src
            └── main
                 ├── java
                 │    └── com.package.myapp
                 └── res
                      ├── drawable
                      ├── layout
                      └── etc.
```

## Gradle Wrapper

使用 Gradle Wrapper 可以避免由于 Gradle 版本更新导致的问题。

你也可以利用命令`./gradlew -v`来查看当前 Gradle 版本。下列是 wrapper 的文件夹结构：

```bash
myapp/
  ├── gradlew
  ├── gradlew.bat
  └── gradle/wrapper/
                ├── gradle-wrapper.jar
                └── gradle-wrapper.properties
```