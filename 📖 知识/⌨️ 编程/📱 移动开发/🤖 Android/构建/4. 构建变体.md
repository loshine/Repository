# 构建变体

当你在开发一个 App 的时候，通常会有好几个版本。

大多数情况是你需要一个开发版本，用来测试 App，然后还需要一个生产版本。 这些版本通常有不同的设置，例如不同的 URL 地址。更可能的是你可能需要一个免费版和收费版本。

基于上述情况，你需要处理不同的版本：开发免费版，开发付费版本，生产免费版，生产付费版，而针对不同的版本不同的配置，这极大增加的管理难度。

Gradle 有一些方便的方法来管理这些问题，本部分就是讲解如何方便管理多个版本的 App。

## 构建版本

在 Gradle 的 Android 插件中，一个构建版本意味着定义一个 App 或者依赖库如何被构建。每个构建版本都要特殊的一面，比如是否需要 debug，application id 是什么，是否不需要的资源被删除等等。你可以通过`buildTypes`方法定义一个构建版本。例如：

```groovy
android {
    buildTypes {
        release {
            minifyEnabled false
            proguardFiles getDefaultProguardFile ('proguard-android.txt'), 'proguard-rules.pro'
        }
    }
}
```

这个文件定义了该模块是 release 版本，然后定义了 proguard 的位置。该 release 版本不是唯一的构建版本，默认情况下，还有个 debug 版本。Android studio 把它视为**默认构建版本**。

### 创建构建版本

当默认的构建版本不够用的时候，我们只需要在`buildTypes`写入自己的版本就可以完成构建版本的创建了。如下所示：

```groovy
android {
    buildTypes {
        staging {
            applicationIdSuffix ".staging"
            versionNameSuffix "-staging"
            buildConfigField "String", "API_URL", "\"http://staging.example.com/api\""
        }
    }
}
```

我们定义了一个 staging 版本，该版本定义了一个新的 application id，这让其与 debug 和 release 版本的 applicationID 不同。假设你使用了默认的配置，那么 applicationID 将会是这样的：

* Debug: `com.package`
* Release: `com.package`
* Staging: `com.package.staging`